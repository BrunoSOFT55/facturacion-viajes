<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Comprobante de Servicio - Altamirano Nosiglia Viajes</title>

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0b1f3a">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
:root{
 --azul:#0b1f3a;
 --azul2:#162f5f;
 --gris:#f3f5f8;
}
body{background:#dde3ee;font-family:'Segoe UI',sans-serif;}
.factura-box{max-width:950px;margin:auto;background:#fff;padding:40px;border-radius:14px;box-shadow:0 18px 40px rgba(0,0,0,.18);border-top:12px solid var(--azul);}
.encabezado{display:flex;justify-content:space-between;border-bottom:2px solid var(--azul);padding-bottom:18px;margin-bottom:30px;}
.encabezado img{max-height:90px}
.marca{font-size:24px;font-weight:800;color:var(--azul);}
.sub{font-size:13px;color:#666}
.factura-titulo{color:var(--azul2);font-weight:700}
.table thead{background:var(--azul2);color:#fff}
.total-box{background:#f3f5f8;border:2px solid var(--azul2);padding:18px;border-radius:10px;font-size:24px;font-weight:800;color:var(--azul2)}
.btn-success{background:var(--azul);border:none}
.btn-success:hover{background:var(--azul2)}
@media print{
 body{background:#fff}
 .no-print,#tablaHistorial,#buscar,h5.mt-4,footer{display:none!important}
}
@media(max-width:576px){
 .encabezado{flex-direction:column;text-align:center}
 .marca{font-size:18px}
}
@media(max-width:480px){
 .factura-box{padding:18px;border-radius:10px}
 .encabezado img{max-width:160px;margin:0 auto 10px;display:block}
 .marca{font-size:17px}
 .factura-titulo{font-size:14px}
 h5{font-size:15px;margin-top:14px}
 input,button{font-size:14px!important}
}
</style>
</head>

<body>

<!-- CONTENIDO ORIGINAL: FORMULARIO, TABLA, BOTONES -->
<!-- Reemplazá aquí tu HTML original tal cual estaba -->

<footer class="bg-dark text-white text-center py-4 mt-5 border-top border-secondary">
  <div class="container">
    Rodríguez Bruno<br>
    <small class="text-secondary">
      Técnico en Desarrollo de Software<br>
      Sistemas web · Aplicaciones · Soluciones digitales
    </small>
  </div>
</footer>

<!-- TU JS ORIGINAL: funciones agregar, guardarHistorial, cargarHistorial, filtrarHistorial, nuevaFactura, enviarWhats -->
<script>
let total = 0;

function agregar() {
  if(!desc.value || !precio.value) return;
  let p = parseFloat(precio.value);
  total += p;
  tabla.querySelector("tbody").innerHTML += `<tr><td>${desc.value}</td><td class='text-end'>$${p.toFixed(2)}</td></tr>`;
  document.getElementById("total").innerText = total.toFixed(2);
  desc.value = "";
  precio.value = "";
}

function enviarWhats() {
  let msg = `Hola ${cliente.value}, te enviamos tu comprobante.\nFecha: ${fecha.value}\nTotal: $${total.toFixed(2)}`;
  window.open("https://wa.me/54"+telefono.value+"?text="+encodeURIComponent(msg));
}

function guardarHistorial() {
  let hist = JSON.parse(localStorage.getItem("historial") || "[]");
  hist.push({cliente: cliente.value, fecha: fecha.value, total: total.toFixed(2)});
  localStorage.setItem("historial", JSON.stringify(hist));
  cargarHistorial();
  alert("Factura guardada");
}

function cargarHistorial() {
  let hist = JSON.parse(localStorage.getItem("historial") || "[]");
  let tbody = document.querySelector("#tablaHistorial tbody");
  tbody.innerHTML = "";
  hist.reverse().forEach(h => {
    tbody.innerHTML += `<tr>
      <td>${h.fecha}</td>
      <td>${h.cliente}</td>
      <td class="text-end">$${h.total}</td>
    </tr>`;
  });
}

function filtrarHistorial() {
  let q = buscar.value.toLowerCase();
  let tabla = document.getElementById("tablaHistorial");
  if(q === "") {
    tabla.classList.add("d-none");
    return;
  }
  tabla.classList.remove("d-none");
  document.querySelectorAll("#tablaHistorial tbody tr").forEach(fila => {
    fila.style.display = fila.innerText.toLowerCase().includes(q) ? "" : "none";
  });
}

function nuevaFactura() {
  if(!confirm("¿Desea iniciar una nueva factura? Se borrarán los datos actuales.")) return;
  cliente.value = ""; dni.value = ""; telefono.value = ""; desc.value = ""; precio.value = ""; fecha.value = "";
  tabla.querySelector("tbody").innerHTML = "";
  total = 0;
  document.getElementById("total").innerText = "0,00";
}

window.onload = cargarHistorial;
</script>

<!-- REGISTRO DEL SERVICE WORKER PARA PWA -->
<script>
if('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js')
    .then(()=> console.log("Service Worker registrado"))
    .catch(err=> console.log("Error registrando SW:", err));
}
</script>

</body>
</html>












